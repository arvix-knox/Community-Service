
# ğŸ˜ï¸ Community Service

<div align="center">

![Python](https://img.shields.io/badge/Python-3.12-blue?logo=python)
![FastAPI](https://img.shields.io/badge/FastAPI-0.115-green?logo=fastapi)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-16-blue?logo=postgresql)
![Redis](https://img.shields.io/badge/Redis-7-red?logo=redis)
![Kafka](https://img.shields.io/badge/Kafka-3.7-black?logo=apachekafka)
![Docker](https://img.shields.io/badge/Docker-Compose-blue?logo=docker)

**ĞœĞ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ°Ğ¼Ğ¸, ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°Ğ¼Ğ¸, ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼, Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸ Ğ¸ Ğ´Ğ¾Ğ½Ğ°Ñ‚Ğ°Ğ¼Ğ¸.**

</div>

---

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

- [ĞĞ±Ğ·Ğ¾Ñ€](#-Ğ¾Ğ±Ğ·Ğ¾Ñ€)
- [Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸](#-Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸)
- [Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚](#-Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹-ÑÑ‚Ğ°Ñ€Ñ‚)
- [ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ](#-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ)
- [Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°](#-ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°-Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°)
- [API Reference](#-api-reference)
- [ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…](#-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
- [Event System](#-event-system)
- [ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ](#-ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)
- [Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ](#-Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ)
- [Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ](#-Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)
- [Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ¸ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ](#-Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹-Ğ¸-Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)
- [ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³](#-Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³)
- [FAQ](#-faq)

---

## ğŸ” ĞĞ±Ğ·Ğ¾Ñ€

Community Service â€” Ğ°Ğ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ñ‹Ğ¹ REST API Ğ¼Ğ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸Ñ, Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ÑÑ‰Ğ¸Ğ¹ Ğ·Ğ° Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¶Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹
Ñ†Ğ¸ĞºĞ» ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ² Ğ² Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğµ. Stateless, Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğ¹, event-driven.

### Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Nginx     â”‚ :80
                    â”‚  (LB/Proxy) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚            â”‚            â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
        â”‚  App :8000 â”‚ â”‚App :8000â”‚ â”‚App :8000â”‚
        â”‚ (Worker 1) â”‚ â”‚(Worker 2)â”‚ â”‚(Worker 3)â”‚
        â””â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”˜
           â”‚  â”‚  â”‚        â”‚  â”‚        â”‚  â”‚
     â”Œâ”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”˜  â”‚
     â”‚        â”‚              â”‚  â”‚         â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”´â”   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”
â”‚Postgresâ”‚ â”‚Redis â”‚    â”‚ Kafka  â”‚   â”‚ MinIO  â”‚
â”‚  :5432 â”‚ â”‚:6379 â”‚    â”‚ :9092  â”‚   â”‚ :9000  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ¨ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|
| **Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ°** | CRUD, Ğ¿Ğ¾Ğ¸ÑĞº, Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ / Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğµ / Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ |
| **Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸** | Ğ’ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğµ, Ğ²Ñ‹Ñ…Ğ¾Ğ´, Ğ±Ğ°Ğ½, Ğ¼ÑƒÑ‚, Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ñ€Ğ¾Ğ»ĞµĞ¹ |
| **Ğ Ğ¾Ğ»Ğ¸ Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°** | Ğ“Ğ¸Ğ±ĞºĞ°Ñ RBAC-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ¼ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ |
| **ĞŸĞ¾ÑÑ‚Ñ‹** | ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ, Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ, Ğ·Ğ°ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ, Ğ¼ĞµĞ´Ğ¸Ğ° |
| **ĞšĞ°Ğ½Ğ°Ğ»Ñ‹** | Ğ¢ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞºĞ°Ğ½Ğ°Ğ»Ñ‹ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° |
| **Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ** | ĞœĞµÑ€Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ Ñ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼ |
| **ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸** | Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ Ñ Ñ‚Ğ°Ñ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ |
| **Ğ”Ğ¾Ğ½Ğ°Ñ‚Ñ‹** | ĞŸÑ€Ğ¸Ñ‘Ğ¼ Ğ¿Ğ¾Ğ¶ĞµÑ€Ñ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ |
| **ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°** | Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ Ğ¿Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ñƒ, Ğ¿Ğ¾ÑÑ‚Ğ°Ğ¼, ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°Ğ¼ |

---

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1 â€” Docker (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)

```bash
# Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
python generate_project.py

cd community-service

# ĞŸĞ¾Ğ´Ğ½ÑÑ‚ÑŒ Ğ²ÑÑ‘
docker-compose up --build -d

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ
curl http://localhost:8000/health
```

Swagger UI Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¿Ğ¾ Ğ°Ğ´Ñ€ĞµÑÑƒ `http://localhost:8000/api/docs` (Ğ¿Ñ€Ğ¸ `DEBUG=true`).

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2 â€” Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

```bash
cd community-service

python -m venv venv
source venv/bin/activate        # Linux / Mac
# venv\Scripts\activate         # Windows

pip install -r requirements.txt

# ĞŸĞ¾Ğ´Ğ½ÑÑ‚ÑŒ Ğ‘Ğ” Ğ¸ Redis
docker-compose up -d postgres redis

# ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
alembic revision --autogenerate -m "initial"
alembic upgrade head

# Ğ—Ğ°Ğ¿ÑƒÑĞº
python main.py
```

---

## âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

Ğ’ÑĞµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ñ‡Ğ¸Ñ‚Ğ°ÑÑ‚ÑÑ Ğ¸Ğ· `.env`. Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ â€” `.env.example`.

### Application

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `APP_NAME` | community-service | Ğ˜Ğ¼Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ° |
| `APP_PORT` | 8000 | ĞŸĞ¾Ñ€Ñ‚ |
| `DEBUG` | false | Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Swagger |
| `WORKERS_COUNT` | 4 | Gunicorn workers |

### PostgreSQL

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `DATABASE_URL` | postgresql+asyncpg://... | Connection string |
| `DB_POOL_SIZE` | 20 | Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¿ÑƒĞ»Ğ° |
| `DB_MAX_OVERFLOW` | 10 | Ğ”Ğ¾Ğ¿. ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ |

### Redis

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `REDIS_URL` | redis://localhost:6379/0 | Connection string |
| `CACHE_DEFAULT_TTL` | 300 | TTL Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ, ÑĞµĞº |
| `CACHE_ANALYTICS_TTL` | 600 | TTL Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸, ÑĞµĞº |

### JWT

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `JWT_SECRET_KEY` | change-me | Ğ¡ĞµĞºÑ€ĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ |
| `JWT_ALGORITHM` | HS256 | ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ |

### Event Broker

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `EVENT_BROKER_TYPE` | kafka | `kafka` Ğ¸Ğ»Ğ¸ `rabbitmq` |
| `KAFKA_BOOTSTRAP_SERVERS` | localhost:9092 | Ğ¡ĞµÑ€Ğ²ĞµÑ€Ñ‹ Kafka |
| `RABBITMQ_URL` | amqp://guest:guest@... | URL RabbitMQ |

### S3 / MinIO

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `S3_ENDPOINT` | http://localhost:9000 | Endpoint |
| `S3_ACCESS_KEY` | minioadmin | ĞšĞ»ÑÑ‡ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° |
| `S3_SECRET_KEY` | minioadmin | Ğ¡ĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ |
| `S3_BUCKET` | community-media | Ğ‘Ğ°ĞºĞµÑ‚ |

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
community-service/
â”œâ”€â”€ main.py                        # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ alembic.ini
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env / .env.example
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/                      # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³, JWT, RBAC, Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸, Ğ»Ğ¾Ğ³Ğ¸
â”‚   â”œâ”€â”€ domain/                    # SQLAlchemy-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸, enums
â”‚   â”œâ”€â”€ schemas/                   # Pydantic DTO (request / response)
â”‚   â”œâ”€â”€ repositories/              # Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ CRUD + ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)
â”‚   â”œâ”€â”€ services/                  # Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
â”‚   â”œâ”€â”€ api/                       # Ğ Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹, middleware, dependencies
â”‚   â”‚   â””â”€â”€ v1/                    # Ğ’ĞµÑ€ÑĞ¸Ñ API
â”‚   â”œâ”€â”€ events/                    # Event publishing (Kafka / RabbitMQ)
â”‚   â”œâ”€â”€ infrastructure/            # Redis, S3, DI-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
â”‚   â””â”€â”€ db/                        # AsyncEngine, SessionFactory
â”‚
â”œâ”€â”€ migrations/                    # Alembic
â”œâ”€â”€ docker/                        # entrypoint.sh, nginx.conf
â””â”€â”€ tests/
```

---

## ğŸ“¡ API Reference

**Base URL:** `http://localhost:8000/api/v1`

### ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ

Ğ—Ğ°Ñ‰Ğ¸Ñ‰Ñ‘Ğ½Ğ½Ñ‹Ğµ endpoints Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº:

```
Authorization: Bearer <jwt_token>
```

JWT payload:

```json
{
  "sub": "550e8400-e29b-41d4-a716-446655440000",
  "email": "user@example.com",
  "roles": ["admin"],
  "permissions": ["community.create", "post.create"],
  "is_superadmin": false
}
```

### Communities

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº (Ğ¿Ğ¾Ğ¸ÑĞº, Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ) | â€” |
| `GET` | `/communities/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ | â€” |
| `POST` | `/communities` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | âœ… |
| `PUT` | `/communities/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… owner |
| `DELETE` | `/communities/{id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ | âœ… owner |

<details>
<summary>ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹</summary>

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ
curl -X POST http://localhost:8000/api/v1/communities \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"Python Devs","community_type":"public"}'

# Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ¼
curl "http://localhost:8000/api/v1/communities?search=python&page=1&page_size=10"
```

ĞÑ‚Ğ²ĞµÑ‚:
```json
{
  "items": [{ "id": "...", "name": "Python Devs", "slug": "python-devs-a1b2c3d4", ... }],
  "total": 1, "page": 1, "page_size": 10, "pages": 1
}
```
</details>

### Members

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/members` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `POST` | `/communities/{id}/members` | Ğ’ÑÑ‚ÑƒĞ¿Ğ¸Ñ‚ÑŒ | âœ… |
| `PUT` | `/communities/{id}/members/{user_id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… |
| `DELETE` | `/communities/{id}/members/{user_id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ / Ğ²Ñ‹Ğ¹Ñ‚Ğ¸ | âœ… |

### Roles

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/roles` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `POST` | `/communities/{id}/roles` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | âœ… |
| `PUT` | `/communities/{id}/roles/{role_id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… |
| `DELETE` | `/communities/{id}/roles/{role_id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ | âœ… |

### Posts

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/posts` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `GET` | `/posts/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ | â€” |
| `POST` | `/communities/{id}/posts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | âœ… |
| `PUT` | `/posts/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… author |
| `DELETE` | `/posts/{id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ | âœ… author |

### Channels

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/channels` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `POST` | `/communities/{id}/channels` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | âœ… |
| `PUT` | `/channels/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… |
| `DELETE` | `/channels/{id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ | âœ… |

### Events

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/events` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `GET` | `/events/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ | â€” |
| `POST` | `/communities/{id}/events` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ | âœ… |
| `PUT` | `/events/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ | âœ… |
| `DELETE` | `/events/{id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ | âœ… |

### Subscriptions

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/subscriptions` | Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `POST` | `/communities/{id}/subscriptions` | ĞÑ„Ğ¾Ñ€Ğ¼Ğ¸Ñ‚ÑŒ | âœ… |

### Donations

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/donations` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº | â€” |
| `POST` | `/communities/{id}/donations` | Ğ¡Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ´Ğ¾Ğ½Ğ°Ñ‚ | âœ… |

### Analytics

| ĞœĞµÑ‚Ğ¾Ğ´ | ĞŸÑƒÑ‚ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Auth |
|---|---|---|---|
| `GET` | `/communities/{id}/analytics` | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° | âœ… |
| `GET` | `/posts/{id}/analytics` | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ÑÑ‚Ğ° | âœ… |
| `GET` | `/members/{id}/analytics` | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ° | âœ… |

### Health

```
GET /health â†’ {"status":"healthy","service":"community-service","version":"1.0.0"}
```

---

## ğŸ“Š ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### ER-Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Community   â”‚â”€â”€â”€â”€<â”‚    Member    â”‚>â”€â”€â”€â”€â”‚      Role        â”‚
â”‚              â”‚     â”‚              â”‚  M2Mâ”‚                  â”‚
â”‚ id (UUID)    â”‚     â”‚ id (UUID)    â”‚     â”‚ id (UUID)        â”‚
â”‚ name         â”‚     â”‚ community_id â”‚     â”‚ community_id     â”‚
â”‚ slug (uniq)  â”‚     â”‚ user_id      â”‚     â”‚ name             â”‚
â”‚ type         â”‚     â”‚ status       â”‚     â”‚ permissions_list â”‚
â”‚ status       â”‚     â”‚ is_owner     â”‚     â”‚ is_default       â”‚
â”‚ owner_id     â”‚     â”‚ nickname     â”‚     â”‚ priority         â”‚
â”‚ member_count â”‚     â”‚ joined_at    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ post_count   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€< Post         (community_id, channel_id, author_id, content, status, media_urls[])
       â”œâ”€â”€< Channel      (community_id, name, type, position)
       â”œâ”€â”€< Event        (community_id, creator_id, title, starts_at, ends_at, status)
       â”œâ”€â”€< SubLevel     (community_id, name, price, duration_days, features)
       â”‚       â””â”€â”€< Subscription  (level_id, user_id, community_id, status, starts_at, expires_at)
       â””â”€â”€< Donation     (community_id, donor_id, amount, currency, message, is_anonymous)
```

Ğ’ÑĞµ Ğ¿ĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸ â€” **UUID v4**.

---

## ğŸ“¨ Event System

### Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ

| Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ |
|---|---|
| `community.created` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° |
| `community.updated` | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ |
| `community.deleted` | Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ |
| `member.joined` | Ğ’ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ° |
| `member.left` | Ğ’Ñ‹Ñ…Ğ¾Ğ´ / ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ |
| `post.created` | ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ÑÑ‚Ğ° |
| `post.updated` | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ |
| `post.deleted` | Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ |
| `donation.received` | ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ½Ğ°Ñ‚Ğ° |
| `subscription.started` | ĞÑ„Ğ¾Ñ€Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |
| `subscription.ended` | ĞĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ |
| `event.created` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¼ĞµÑ€Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ |
| `event.updated` | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ |
| `event.deleted` | Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ |

### Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚

```json
{
  "event_id": "550e8400-...",
  "event_type": "community.created",
  "timestamp": "2024-01-01T12:00:00Z",
  "service": "community-service",
  "payload": { "community_id": "...", "owner_id": "...", "name": "..." },
  "metadata": {}
}
```

### ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ±Ñ€Ğ¾ĞºĞµÑ€Ğ°

```env
EVENT_BROKER_TYPE=kafka      # Ğ¸Ğ»Ğ¸ rabbitmq
```

Ğ•ÑĞ»Ğ¸ Ğ±Ñ€Ğ¾ĞºĞµÑ€ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ â€” ÑĞµÑ€Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ, ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ.

---

## ğŸ’¨ ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ§Ñ‚Ğ¾ ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ÑÑ

| Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ | TTL | ĞšĞ»ÑÑ‡ |
|---|---|---|
| Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾ ID | 5 Ğ¼Ğ¸Ğ½ | `community:{id}` |
| Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ² | 5 Ğ¼Ğ¸Ğ½ | `communities:list:{page}:{size}` |
| Ğ Ğ¾Ğ»Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° | 5 Ğ¼Ğ¸Ğ½ | `community:{id}:roles` |
| ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° | 10 Ğ¼Ğ¸Ğ½ | `community:{id}:analytics` |
| ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ÑÑ‚Ğ° | 10 Ğ¼Ğ¸Ğ½ | `post:{id}:analytics` |
| Top donors | 5 Ğ¼Ğ¸Ğ½ | `community:{id}:top_donors` |

### Ğ˜Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ

- ĞŸÑ€Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ (create / update / delete) â€” Ñ‚Ğ¾Ñ‡ĞµÑ‡Ğ½Ğ¾Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ°
- Pattern-based ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ñ… ÑĞ¿Ğ¸ÑĞºĞ¾Ğ²
- Ğ•ÑĞ»Ğ¸ Redis Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ â€” Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸Ğ´ÑƒÑ‚ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ² PostgreSQL

---

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### JWT

Ğ¢Ğ¾ĞºĞµĞ½ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ÑÑ Ğ² middleware. Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ â†’ `request.state.user` (`UserContext`).

### RBAC

17 Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹, Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ñ… Ğº Ñ€Ğ¾Ğ»ÑĞ¼:

```
community.create / update / delete / view
member.manage / kick / ban
role.manage
post.create / update / delete / moderate
channel.manage
event.manage
subscription.manage
analytics.view
donation.view
```

- **Ğ’Ğ»Ğ°Ğ´ĞµĞ»ĞµÑ†** ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ° (`is_owner=True`) â€” Ğ²ÑĞµ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
- **Ğ¡ÑƒĞ¿ĞµÑ€Ğ°Ğ´Ğ¼Ğ¸Ğ½** (`is_superadmin=True` Ğ² JWT) â€” Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
- Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ ĞºĞ°Ğº `ARRAY(String)` Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ `roles`

### Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ

- Ğ’ÑĞµ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Pydantic v2
- SQLAlchemy â€” Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ (Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL-Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹)
- ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ğ¸Ğ½Ñ‹ Ğ¿Ğ¾Ğ»ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· `Field(max_length=...)`

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
# Ğ’ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹
pytest tests/ -v

# Ğ¡ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼
pytest tests/ --cov=app --cov-report=html
```

### Ğ¤Ğ¸ĞºÑÑ‚ÑƒÑ€Ñ‹

| Ğ¤Ğ¸ĞºÑÑ‚ÑƒÑ€Ğ° | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|
| `client` | ĞĞµĞ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ HTTP-ĞºĞ»Ğ¸ĞµĞ½Ñ‚ |
| `auth_client` | ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ (JWT-Ñ‚Ğ¾ĞºĞµĞ½) |

---

## ğŸš¢ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ¸ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ“Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
docker-compose up --scale community-app=5 -d
```

Nginx Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¸Ñ€ÑƒĞµÑ‚ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ (`least_conn`).

### Production-Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

```env
DEBUG=false
WORKERS_COUNT=4            # 2 * CPU + 1
DB_POOL_SIZE=20
JWT_SECRET_KEY=<Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğ¹ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡>
```

### Docker

- Multi-stage build (builder â†’ runtime)
- ĞĞµĞ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ (`appuser`)
- Health check Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½
- Entrypoint: Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ â†’ Gunicorn + Uvicorn workers

---

## ğŸ“Š ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

### Structured Logging

ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ»Ğ¾Ğ³ â€” JSON:

```json
{
  "timestamp": "2024-01-01T12:00:00Z",
  "level": "INFO",
  "message": "Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾",
  "service": "community-service",
  "user_id": "...",
  "community_id": "...",
  "action": "community_created",
  "duration_ms": 45.2,
  "request_id": "abc-123"
}
```

### Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°

```
X-Request-ID: abc-123-def
X-Response-Time: 45.2ms
```

---

## â“ FAQ

### ĞšĞ°Ğº Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²ÑƒÑ ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚ÑŒ?

1. ĞœĞ¾Ğ´ĞµĞ»ÑŒ â†’ `app/domain/models.py`
2. Ğ¡Ñ…ĞµĞ¼Ñ‹ â†’ `app/schemas/`
3. Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ â†’ `app/repositories/`
4. Ğ¡ĞµÑ€Ğ²Ğ¸Ñ â†’ `app/services/`
5. Router â†’ `app/api/v1/`
6. ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ â†’ `app/infrastructure/container.py`
7. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€ â†’ `app/api/v1/router.py`
8. ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ â†’ `alembic revision --autogenerate -m "add ..."`

### ĞšĞ°Ğº Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ½Ğ° RabbitMQ?

```env
EVENT_BROKER_TYPE=rabbitmq
```

### ĞšĞ°Ğº Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Swagger?

```env
DEBUG=false
```

### ĞšĞ°Ğº Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Auth Service?

Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ´ĞµĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² `app/core/security.py` Ğ½Ğ° HTTP-Ğ²Ñ‹Ğ·Ğ¾Ğ² Ğº Auth Service.

---

<div align="center">

**Community Service v1.0.0**

</div>
```
